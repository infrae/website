<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Infrae Mobile: infrae.testing</title>
    <base href="" />
    <meta name="description" content="Infrae mobile site: Download areas for all of Infrae's open source products." />
    <meta name="keywords" content="mobile, smartphone, Android, iOS, download, open source, software, products, infrae" />
    <meta name="generator" content="Silva" />
    <meta name="viewport" content="width=device-width,user-scalable=yes" />
    <link rel="shortcut icon" href="../../++static++/silvatheme.infraemobile/:version:2013-12-19T15:20:12/favicon.ico" />

    <link rel="apple-touch-icon" href="../../++static++/silvatheme.infraemobile/:version:2013-12-19T15:20:12/mobicon.png" />
    <style>#contactus {display: none;}</style>

    
  <link rel="stylesheet" type="text/css" href="../../++static++/silvatheme.infraemobile/:version:2013-12-19T15:20:12/:bundle:infraemobile.css%3Binfraemobile_advanced.css" />
<script type="text/javascript" src="../../++static++/jquery/:version:1.8.2/jquery.min.js"></script>
</head>

  <body class="infrae-testing">
    <div id="site" class="">
  <div id="header"><div class="breadcrumbs"><div class="menu bc">
  <div id="home" class="bci bchome">
    <a href="../../index.html">
      <img width="72" height="36" alt="Home" src="../../++static++/silvatheme.infraemobile/:version:2013-12-19T15:20:12/images/homelink.png"
           />
    </a>
  </div>
  <div id="sitemap-switch-button" class="buttons" >
  <a id="sitemap-switch-button-link" href="infrae.testing.html#top"
    width="36" height="36" alt="Sitemap"
    title="show sitemap"
    onclick="
      window.location.hash = 'top';
      var cur = $(this);
      $('#sitemap').slideToggle('fast',
      function(){cur.toggleClass('selected')});
      return false;">
    <img height="36" width="36" alt="Sitemap button" src="../../++static++/silvatheme.infraemobile/:version:2013-12-19T15:20:12/images/sitemap.png"
    />
  </a>
</div>

  <div class="title bci">
    <a href="../tools.html">Tools</a>
  </div>
</div>
</div>
</div>
  <div id="behindheader">
    <a name="top" href="mailto:torvald@infrae.com">
      Looking under the hood? Interested in a job? Send a mail....
    </a>
  </div>
  <div id="sitemap" style="display: none"><div class="navigation">
  <ul id="navigation-menu" class="navigation-level-0">
    
      <li class="level-0">
        <a href="../../news.html" title="News">News</a>
        
      </li>
    
    
      <li class="level-0">
        <a href="../../about.html" title="About">About</a>
        
      </li>
    
    
      <li class="level-0">
        <a href="../../products.html" title="Products">Products</a>
        
      </li>
    
    
      <li class="level-0 selected">
        <a href="../../download.html" title="Download" class="onbranch">Download</a>
        
          
            <ul class="navigation-level-1">
    
      <li class="level-1 selected">
        <a href="../tools.html" title="Tools" class="onbranch">Tools</a>
        
          
            <ul class="navigation-level-2">
    
      <li class="level-2">
        <a href="infrae.wsgi.html" title="infrae.wsgi">infrae.wsgi</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="infrae.testbrowser.html" title="infrae.testbrowser">infrae.testbrowser</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="infrae.fileupload.html" title="infrae.fileupload">infrae.fileupload</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="infrae.layout.html" title="infrae.layout">infrae.layout</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="infrae.rest.html" title="infrae.rest">infrae.rest</a>
        
      </li>
    
    
      <li class="level-2 selected">
        <a href="infrae.testing.html" title="infrae.testing" class="selected">infrae.testing</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="infrae.i18nextract.html" title="infrae.i18nextract">infrae.i18nextract</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="infrae.maildrophost.html" title="infrae.maildrophost">infrae.maildrophost</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="infrae.uwsgi.html" title="infrae.uwsgi">infrae.uwsgi</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="infrae.copyright.html" title="infrae.copyright">infrae.copyright</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="infrae.cache.html" title="infrae.cache">infrae.cache</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="infrae.comethods.html" title="infrae.comethods">infrae.comethods</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="z3locales.html" title="z3locales">z3locales</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="sparrow.html" title="Sparrow">Sparrow</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="../Sprout.html" title="Sprout">Sprout</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="../../infrae.com/infrae.com/download/ptprofiler.html" title="PTProfiler">PTProfiler</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="../zsparklines.html" title="ZSparklines">ZSparklines</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="i18nextract-sa.html" title="i18nextract stand-alone">i18nextract stand-alone</a>
        
      </li>
    
    
      <li class="level-2">
        <a href="../pydavclient.html" title="PyDAV Client">PyDAV Client</a>
        
      </li>
    
  </ul>
          
        
      </li>
    
    
      <li class="level-1">
        <a href="../mobi.html" title="Mobi">Mobi</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../OAI.html" title="OAI Components">OAI Components</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../DocumentLibrary.html" title="OAI Document Library">OAI Document Library</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../silva_all.html" title="Silva CMS Packages">Silva CMS Packages</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../silva_all_archive.html" title="Silva CMS Archive">Silva CMS Archive</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../silva_components.html" title="Silva Components">Silva Components</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../silva_extensions.html" title="Silva Extensions">Silva Extensions</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../silva_extensions_archive.html" title="Silva Extensions Archive">Silva Extensions Archive</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../fedoracommons.html" title="Fedora Commons Repository">Fedora Commons Repository</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../railroad.html" title="Railroad Repository">Railroad Repository</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../tramline.html" title="Tramline">Tramline</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../Formulator.html" title="Formulator">Formulator</a>
        
      </li>
    
    
      <li class="level-1">
        <a href="../LICENSE.txt.html" title="License">License</a>
        
      </li>
    
  </ul>
          
        
      </li>
    
    
      <li class="level-0">
        <a href="../../service.html" title="Services">Services</a>
        
      </li>
    
    
      <li class="level-0">
        <a href="../../contact.html" title="Contact">Contact</a>
        
      </li>
    
    
      <li class="level-0">
        <a href="../../presentations.html" title="Presentations">Presentations</a>
        
      </li>
    
    
      <li class="level-0">
        <a href="../../search.html" title="Inactive Search">Inactive Search</a>
        
      </li>
    
  </ul>
</div>
</div>
  <div id="content">
    
    

  <a href="infrae.testing.html#skip-to-releases" class="skip-link"
     style="float: right">
    Jump to releases
  </a>

  

  
  
  <h2>infrae.testing</h2>
<p> infrae.testing defines sanes tests layers for testing in Zope 2, to
use in conjunction with <a class="link" title="" target="" href="http://pypi.python.org/pypi/zope.testing">zope.testing</a>.</p>
<p> Contents</p>
<ul class="disc"><li><p><a class="link" title="" target="" href="infrae.testing.html#api">API</a></p></li><li><p><a class="link" title="" target="" href="infrae.testing.html#examples">Examples</a></p><ul class="disc"><li><a class="link" title="" target="" href="infrae.testing.html#zcmllayer">ZCMLLayer</a></li><li><a class="link" title="" target="" href="infrae.testing.html#zope2layer">Zope2Layer</a></li></ul></li><li><p><a class="link" title="" target="" href="infrae.testing.html#code">Code</a></p></li></ul><h2><a class="link" title="" target="" href="infrae.testing.html#id1">API</a></h2>
<p> It defines:</p>
<ul class="disc"><li><p>A ZMLLayer which load a ZCML file before your test, and clean
up after,</p></li><li><p>A Zope2Layer which setup a Zope 2 test instance in a layer.</p><p> You can customize the layer setup to add your tested application
(like to create a Portal instance).</p><p> If you define the shell environment variable SETUP_CACHE while
running the tests, this last setup step will be cached in a
FileSystem Storage. This makes it reusable between different testing
sessions, and let you save a considerable amount of time while
running your tests. Of course don't use the cache if you changed how
you installed your application.</p><p> By default it provides a environment which is exactly equivalent to
the one provided by a real running Zope 2 instance (with all VHM,
session support, temp_folder ...).</p><p> If you compare it to the code of the Testing module in Zope 2,
it does the same thing, but it is simpler (and so readable), provides
an environment which match more a running one and is faster (as you can
cache the setup operation).</p><p> Every test is run in a separate DemoStorage (installed on top of the
storage providing the installed application).</p></li><li><p>A TestCase base class that provides a bit more of assert methods:</p><dl class="dl"><dt>assertTriggersEvents(*events)</dt><dd>Context manager that will assert that the events with the given
names have been triggered. </dd><dt>assertNotTriggersEvents(*events)</dt><dd>Context manager that will assert that the events with the given
names have not been triggered. </dd><dt>assertEventsAre(events, interface=None)</dt><dd>Will assert that the event tiggered up until now are the one
with the names in the given list. You can if you want restrict
those events to the one implementing the given interface. </dd><dt>assertContentEqual(c1, c2)</dt><dd>Will assert that both Zope object are the same. </dd><dt>assertContentItemsEqual(l1, l2)</dt><dd>Will assert that both list contains the same Zope objects. The
order is not important. </dd><dt>assertHashEqual(s1, s2)</dt><dd>Will assert that both md5 hash of the given string are
equal. This is useful when comparing two large string, and that
you wish to have readable output error message. </dd><dt>assertStringEqual(s1, s2)</dt><dd>Will assert that stripped version of both given strings are the same. </dd><dt>assertEventsAre(events, interface=None)</dt><dd>Will assert that the triggered events are the ones whose names
are specified in the given list argument. You can restrict events
to match to those who implements at least the given interface. </dd><dt>assertXMLEqual(xml1, xml2)</dt><dd>Will assert that both given XML strings have the same structure
and data. The XML strings will be indented and after compared
between them. In case of differences, the error will only report
a diff between the indented XML strings.
Of course don't use this method if you wish to compare two XML
strings where spaces matters. An xmlindent script can be installed out of this package
that indent the XML code exactly like the assertXMLEqual
method does. </dd></dl></li><li><p>A TestMethods class that will provide you access to the assert
methods without the need of a test case. This gives you access to
all the default assert methods of the unittest.TestCase and the
ones documented above.</p></li><li><p>The suite_from_package function will construct a
unittest.TestSuite out of files found in a package. A *.txt
file will create DocFileSuite, and a *.py will create a
DocTestSuite. Other type of test files can be plugged in.</p></li></ul><p> If you use the ZCMLLayer or Zope2Layer, you have two different
callbacks registry you can use:</p>
<ul class="disc"><li>testCleanUp that is called after each test,</li><li>layerCleanUp that is called after each layer.</li></ul><p> Those callbacks registry have an add method that can be used in
order to register a new cleanup function:</p>
<pre>
from infrae.testing import testCleanUp

testCleanUp.add(my_cleanup_function)
</pre>
<h2><a class="link" title="" target="" href="infrae.testing.html#id2">Examples</a></h2>
<h2><a class="link" title="" target="" href="infrae.testing.html#id3">ZCMLLayer</a></h2>
<p> A example to test a package called corp.testpackage. The package
as a ftesting.zcml file which should mainly load its own
configure.zcml:</p>
<pre>
import unittest

from infrae.testing import ZCMLLayer
import corp.testpackage

layer = ZCMLLayer(corp.testpackage)


class MyTestCase(unittest.TestCase):

    layer = layer
</pre>
<p> The layer provides you a grok() method that can be used to grok a
module in your test later on.</p>
<h2><a class="link" title="" target="" href="infrae.testing.html#id4">Zope2Layer</a></h2>
<p> Now our corp.testpackage is a Zope 2 extension providing some
content. We want to test it installed:</p>
<pre>
import unittest

from infrae.testing import ZCMLLayer
import corp.testpackage


class CorpLayer(Zope2Layer):
    """Add some installation tasks to the Zope2Layer.
    """
   default_products = Zope2Layer.default_products + ['CMFCore']
   default_packages = Zope2Layer.default_packages + ['corp.testpackage']
   default_users = Zope2Layer.default_users + {'corp_user': 'CorpRole'}

   def _install_application(self, app):
      factory = app.manage_addProduct['corp.testpackage']
      factory.manage_addCorpPortal('portal')

layer = CorpLayer(corp.testpackage)


class MyTestCase(unittest.TestCase):

    layer = layer

    def setUp(self):
        self.root = self.layer.get_application()
        self.layer.login('corp_user')
</pre>
<p> Of course your ZCML <em>must</em> include the ZCML of your package
dependencies. As well we don't recommend to add Five in the layer
as a default_products, it goes crazy (but include it in your ZCML
!).</p>
<p> The layer provides you the following useful methods:</p>
<dl class="dl"><dt>login(username)</dt><dd>Log as a the given username.</dd><dt>logout()</dt><dd>Logout.</dd><dt>get_root_folder()</dt><dd>Return the root of the database, <em>not</em> wrapped in a request.</dd><dt>get_application()</dt><dd>Return the root of the database, wrapped in a request.</dd></dl><h2><a class="link" title="" target="" href="infrae.testing.html#id5">Code</a></h2>
<p> The code is available through a Mercurial repository at:
<a class="link" title="" target="" href="https://hg.infrae.com/infrae.testing">https://hg.infrae.com/infrae.testing</a></p>



  <table class="silvatable list">
    <h2><a name="skip-to-releases">Available releases</a></h2>
    <thead>
      <tr>
        <th class="align-left">Release version</th>
        <th class="align-left">Release date</th>
        <th class="align-left">Release files</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          <a href="infrae.testing/1.3.html">infrae.testing 1.3</a>
        </td>
        <td>2012 9 3  16:34:46 </td>
        <td>
          
            <a href="infrae.testing/1.3/infrae.testing-1.3.tar.gz">infrae.testing-1.3.tar.gz</a><br />
          
        </td>
      </tr>
      <tr>
        <td>
          <a href="infrae.testing/1.2.html">infrae.testing 1.2</a>
        </td>
        <td>2011 11 7  13:55:19 </td>
        <td>
          
            <a href="infrae.testing/1.2/infrae.testing-1.2.tar.gz">infrae.testing-1.2.tar.gz</a><br />
          
        </td>
      </tr>
      <tr>
        <td>
          <a href="infrae.testing/1.1.html">infrae.testing 1.1</a>
        </td>
        <td>2010 10 7  11:09:00 </td>
        <td>
          
            <a href="infrae.testing/1.1/infrae.testing-1.1.tar.gz">infrae.testing-1.1.tar.gz</a><br />
          
        </td>
      </tr>
      <tr>
        <td>
          <a href="infrae.testing/1.0.html">infrae.testing 1.0</a>
        </td>
        <td>2010 7 15  17:41:25 </td>
        <td>
          
            <a href="infrae.testing/1.0/infrae.testing-1.0.tar.gz">infrae.testing-1.0.tar.gz</a><br />
          
        </td>
      </tr>
    </tbody>
  </table>

  <p class="software-license">
    <strong>License:</strong>
    <a href="infrae.testing/LICENSE.txt.html">
      New BSD
    </a>
  </p>

  



  </div>
  <div id="footer">
  <div class="search">
  <form method="get" action="http://m.infrae.com/download/tools/infrae.testing/@@index.html">
    <input class="searchbutton" type="image" src="../../++static++/silvatheme.infraemobile/:version:2013-12-19T15:20:12/images/search.png" />
    <div class="searchtext">
      <input class="text" placeholder="Search..." name="search" type="text"
             />
    </div>
  </form>
</div>

  <table class="nav">
  
    <tr>
      <td class="col1">
        <div class="nav_button">
          <a class="nav_button" href="../../news.html">News</a>
        </div>
      </td>
      <td class="col2">
        <div class="nav_button">
          <a class="nav_button" href="../../about.html">About</a>
        </div>
      </td>
      <td class="col3">
        <div class="nav_button">
          <a class="nav_button" href="../../products.html">Products</a>
        </div>
      </td>
    </tr>
  
  
    <tr>
      <td class="col1">
        <div class="nav_button">
          <a class="nav_button" href="../../download.html">Download</a>
        </div>
      </td>
      <td class="col2">
        <div class="nav_button">
          <a class="nav_button" href="../../service.html">Services</a>
        </div>
      </td>
      <td class="col3">
        <div class="nav_button">
          <a class="nav_button" href="../../contact.html">Contact</a>
        </div>
      </td>
    </tr>
  
  
    <tr>
      <td class="col1">
        <div class="nav_button">
          <a class="nav_button" href="../../presentations.html">Presentations</a>
        </div>
      </td>
    </tr>
  
    <tr>
      <td colspan="3" class="col0">
        <div class="nav_button">
          <a class="nav_button" href="http://infrae.com/download/tools/infrae.testing">
            View this page on the desktop site
          </a>
        </div>
      </td>
    </tr>
</table>

  <div class="channels">
    <a class="button" href="http://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q=Infrae,+Rotterdam,+The+Netherlands&sll=36.244273,-95.712891&sspn=52.071158,72.949219&ie=UTF8&hq=Infrae,&hnear=Rotterdam,+South+Holland,+The+Netherlands&t=h&z=15&iwloc=A">Hoevestraat 10 3033 GC Rotterdam NL</a>
    <a href="tel:+31102437051" class="button left">+31 10 243 7051</a>
    <a class="button right" href="mailto:info@infrae.com">info@infrae.com</a>
  </div>

</div>
</div>



<script type="text/javascript">
    
    $( function(){ 
        $(document).bind('mousedown touchstart', function(){ 
            $('#sitemap').hide('fast', function(){
                $('#sitemap-switch-button-link').removeClass('selected');
            }); 
        });
        
        $('#sitemap, #sitemap-switch-button').bind('mousedown touchstart', function(event){
            event.stopPropagation();
        });       
    });
    
</script>

  </body>
</html>
